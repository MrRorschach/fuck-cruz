<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Accelerometer Demo</title>

  <style>
    .indicatorDot {
      width: 30px;
      height: 30px;
      background-color: #ffab56;
      border-radius: 50%;
      position: fixed;
    }
  </style>

  <script>
    // var myAudio = document.createElement('audio');

    // if (myAudio.canPlayType('audio/mpeg')) {
    //   myAudio.setAttribute('src', 'cruz1.mp3');
    // }
    //TODO Fix this shit
    var slider = document.getElementById("sensitivity")
    console.log(slider.value)
    document.getElementById("sensitivityReading").textContent = slider.value;

    // var x = document.getElementById("sensitivity").value;
    // console.log(x);
    // document.getElementById("sensitivityReading").innerHTML = x;

    // var px = 50; // Position x and y
    // var py = 50;
    // var vx = 0.0; // Velocity x and y
    // var vy = 0.0;
    // var updateRate = 1 / 60; // Sensor refresh rate
    // var started = false;
    // function getAudio() {
    //   myAudio.play();

    // }
    function getAccel() {
      DeviceMotionEvent.requestPermission().then(response => {
        if (response == 'granted') {
          // Add a listener to get smartphone orientation
          // in the alpha-beta-gamma axes (units in degrees)

          var sensitivity = 20;

          // Position variables
          var x1 = 0, y1 = 0, z1 = 0, x2 = 0, y2 = 0, z2 = 0;

          window.addEventListener('devicemotion', function (e) {
            x1 = e.accelerationIncludingGravity.x;
            y1 = e.accelerationIncludingGravity.y;
            z1 = e.accelerationIncludingGravity.z;
          }, false);

          setInterval(function () {
            var change = Math.abs(x1 - x2 + y1 - y2 + z1 - z2);

            if (change > sensitivity) {
              alert('Shake!');
              document.getElementById('accelReading').textContent = change;

            }

            // Update new position
            x2 = x1;
            y2 = y1;
            z2 = z1;
          }, 150);
          //OLD CODE STUFF
        }
      });
    }
  </script>
</head>

<body style="background-color:lightblue;">
  <header>
    <h1>FUCK TED CRUZ</h1>
  </header>
  <button id="accelPermsButton" style="height:50px;" onclick="getAccel()">
    <h1>Get Accelerometer Permissions</h1>
  </button>
  <button id="audioPermsButton" style="height:50px;" onclick="getAudio()">
    <h1>Play Audio</h1>
  </button>
  <input type="range" id="sensitivity" name="sensitivity" min="0" max="100" value="90" step="1">
  <label for="sensitivity">sensitivity</label>
  <h1 id="sensitivityReading"></h1>
  <h1 id="accelReading"></h1>

  <div class="indicatorDot" style="left:30%; top:30%;"></div>
</body>

</html>